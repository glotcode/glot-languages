use crate::language::EditorConfig;
use crate::language::LanguageConfig;
use crate::language::RunConfig;
use crate::language::RunInstructions;
use maud::html;
use maud::Markup;
use std::path::PathBuf;

const EXAMPLE_CODE: &str = r#"
println "Hello World!"
"#;

#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash)]
pub struct Groovy;

impl LanguageConfig for Groovy {
    fn id(&self) -> String {
        "groovy".to_string()
    }

    fn name(&self) -> String {
        "Groovy".to_string()
    }

    fn file_extension(&self) -> String {
        "groovy".to_string()
    }

    fn editor_config(&self) -> EditorConfig {
        EditorConfig {
            default_filename: format!("main.{}", self.file_extension()),
            mode: "ace/mode/groovy".to_string(),
            use_soft_tabs: true,
            soft_tab_size: 4,
            example_code: EXAMPLE_CODE.trim_matches('\n').to_string(),
        }
    }

    fn run_config(&self) -> RunConfig {
        RunConfig {
            container_image: "glot/groovy:latest".to_string(),
            version_command: "groovy --version".to_string(),
        }
    }

    fn logo(&self) -> Markup {
        html! {
            svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 614.061 305.599" {
                path d="M154.977 332.692c0-.806 10.831-18.622 24.07-39.591 13.237-20.97 22.66-38.62 20.938-39.226-1.722-.605-7.68.486-13.24 2.424-16.745 5.837-20.186 4.29-32.693-14.702-13.533-20.549-14.017-22.67-6.962-30.466 4.609-5.092 4.332-6.28-3.232-13.843-4.55-4.55-8.273-9.643-8.273-11.318 0-2.816-30.991-15.589-79.989-32.966-11.11-3.94-20.2-7.83-20.2-8.643s23.471-1.005 52.158-.424l52.157 1.054 5.091-8.03c21.517-33.936 54.01-64.588 68.467-64.588 3.01 0 9.122 2.87 13.58 6.376 7.26 5.71 8.256 9.249 9.55 33.892.794 15.134 2.424 28.496 3.622 29.694 1.198 1.197 4.997-.375 8.444-3.494 4.401-3.983 9.035-5.063 15.568-3.628 6.767 1.486 10.627.469 14.17-3.735 5.313-6.307 31.905-48.938 31.905-51.15 0-.75 5.265-9.756 11.7-20.012s13.847-22.08 16.47-26.278c4.666-7.465 5.397-6.582 33.427 40.399 28.941 48.507 44.518 66.406 52.316 60.117 5.442-4.389 34-4.638 41.982-.366 4.537 2.428 7.42 2.396 9.925-.11 5.2-5.2 17.65-4.294 20.904 1.521 2.564 4.582 3.218 4.582 7.02 0 2.307-2.778 9.137-5.052 15.179-5.052 8.538 0 11.793 1.774 14.614 7.965l3.628 7.964 56.092-1.986c30.851-1.092 56.092-1.287 56.092-.432 0 .854-22.906 10.071-50.902 20.483s-51.367 19.243-51.935 19.625.699 9.493 2.814 20.246c5.505 27.98 1.915 46.626-11.926 61.946-6.209 6.873-16.283 14.144-22.388 16.159-6.104 2.014-11.098 4.386-11.098 5.27s6.515 11.679 14.478 23.989 13.283 22.38 11.822 22.38c-2.385 0-60.47-22.442-150.79-58.26-17.808-7.062-34.026-12.841-36.039-12.841-3.753 0-36.167 12.287-131.224 49.742-55.125 21.721-57.292 22.474-57.292 19.895m113.116-51.253c29.33-11.395 58.417-22.53 64.638-24.746 10.701-3.81 14.28-2.855 66.254 17.686 30.219 11.943 60.033 23.576 66.254 25.852s19.043 7.22 28.493 10.989c10.775 4.297 16.282 5.331 14.771 2.774-16.884-28.56-17.4-29.037-29.1-26.842-14.114 2.648-22.88-.068-27.385-8.485-2.92-5.458-2.029-8.128 5.255-15.73 10.849-11.324 9.144-21.742-4.844-29.611-5.368-3.02-12.141-10.484-15.051-16.587l-5.292-11.097-11.346 7.7c-13.944 9.462-30.95 9.95-45.147 1.294l-10.465-6.381-12.159 8.263c-12.174 8.274-26.19 9.343-40.437 3.084-3.925-1.725-5.656-1.054-5.656 2.19 0 2.57-3.704 6.362-8.232 8.425-13.574 6.185-26.82 4.543-35.802-4.438l-8.19-8.19-6.61 8.403c-3.635 4.622-12.049 11.837-18.697 16.034-8.23 5.195-18.418 17.872-31.917 39.714-10.905 17.645-19.828 32.98-19.828 34.077s8.363-1.527 18.584-5.832 42.58-17.151 71.91-28.546m248.768-12.258c22.255-12.509 27.414-35.649 17.576-78.844-8.22-36.1-12.325-47.913-17.194-49.496-3.37-1.095-3.887.107-1.989 4.617 12.315 29.257 13 43.946 2.24 48.075-7.391 2.837-15.232-7.79-21.399-29.003-4.775-16.426-9.768-23.829-13.534-20.063-.901.901.679 6.12 3.512 11.599 2.832 5.478 6.717 21.974 8.632 36.66 1.915 14.684 5.614 30.06 8.22 34.168 6.771 10.677 17.55 8.104 24.523-5.854 6.894-13.8 7.673-4.607.97 11.436-6.961 16.66-27.635 21.655-51.585 12.465-3.833-1.471-5.13.051-5.13 6.02 0 4.395-2.936 11.723-6.525 16.285l-6.525 8.296 8.949 1.51c15.45 2.61 36.633-.776 49.259-7.871m-320.367-27.538c46.46-13.354 54.762-28.93 39.329-73.788-3.582-10.41-6.512-21.61-6.512-24.886 0-11.157-5.612-6.002-9.818 9.02-5.562 19.865-22.29 36.75-36.345 36.683-12.205-.058-16.182-2.28-21.224-11.858-9.047-17.189.815-43.568 25.97-69.463 18.424-18.966 28.489-20.683 28.489-4.862 0 24.674-17.011 60.995-25.973 55.456-4.382-2.708-3.672-14.667 1.417-23.85 4.327-7.808 3.448-19.707-1.456-19.707-5.687 0-16.946 20.712-18.433 33.91-1.315 11.669-.493 14.506 5.066 17.481 19.483 10.427 45.006-21.395 46.291-57.716.675-19.073-3.017-24.44-14.779-21.489-17.119 4.297-63.235 63.787-63.235 81.574 0 13.913 6.988 23.697 19.288 27.01 20.915 5.631 41.136-4.374 55.464-27.444l6.021-9.696.014 13.173c.016 19.073-12.426 29.127-51.698 41.767-9.777 3.147-18.184 6.055-18.682 6.462-1.82 1.486 16.687 27.476 19.566 27.476 1.633 0 11.191-2.364 21.241-5.253zm279.917-23.68c4.663-5.153 5.486-10.751 4.486-30.548-1.088-21.534-2.278-25.339-10.662-34.09-15.148-15.812-33.86-11.778-22.908 4.938 5.823 8.887 12.926 7.37 10.417-2.225-2-7.643 1.73-7.844 8.228-.444 12.193 13.886 9.115 33.127-5.299 33.127-9.867 0-12.942-4.231-19.373-26.663-2.93-10.22-6.5-18.583-7.931-18.583-4.77 0-6.893 4.209-3.928 7.782 1.611 1.941 6.073 15.891 9.914 31 9.67 38.027 23.177 51.042 37.056 35.706m-183.771.604c1.99-1.335 2.9-7.649 2.078-14.423-1.324-10.927-2.066-11.724-7.972-8.563-8.488 4.542-17.609-4.064-20.703-19.533-2.347-11.735-3.065-11.505 14.026-4.501 2.143.878 7.597-2.104 12.12-6.627 8.274-8.274 10.998-18.213 4.991-18.213a3.24 3.24 0 0 0-3.231 3.232c0 4.649-8.843 3.99-10.835-.808-1.162-2.8-3.638-1.806-8.06 3.232-3.51 3.999-7.796 7.271-9.526 7.271s-4.065-3.272-5.19-7.271c-1.973-7.01-2.214-7.053-6.678-1.222-3.91 5.108-3.946 6.736-.225 10.456 3.941 3.941 11.427 30.871 11.427 41.108 0 12.729 17.529 22.738 27.778 15.862zm58.943-16.875a42.22 42.22 0 0 0 9.13-46.184c-5.17-12.374-14.145-17.005-26.8-13.83-9.402 2.36-23.723 29.777-23.773 45.516-.08 24.53 23.25 32.69 41.443 14.498m-22.084-19.434c-3.555-3.556-6.417-10.464-6.36-15.352.093-8.08.493-8.373 4.396-3.232 4.824 6.356 13.398 7.457 16.682 2.142 1.194-1.932.553-5.132-1.425-7.11-5.082-5.081-4.466-12 1.068-12 6.151 0 14.727 12.515 14.727 21.493 0 6.606-13.445 20.522-19.828 20.522-1.538 0-5.704-2.908-9.26-6.463m86.35 18.583c13.41-14.603 12.103-37.098-3.099-53.326-7.85-8.381-25.293-9.826-32.432-2.687-6.587 6.588-13.164 32.493-10.72 42.228 5.21 20.764 32.4 28.867 46.25 13.785m-27.456-23.615c-5.306-3.716-7.13-8.15-6.978-16.967.169-9.86.684-10.75 2.961-5.114 3.346 8.28 10.363 11.407 16.518 7.36 3.818-2.509 3.64-3.695-1.1-7.328-6.323-4.846-7.556-11.702-2.105-11.702 4.873 0 22.304 19.066 22.304 24.398 0 5.203-12.378 14.385-19.392 14.385-2.764 0-8.258-2.264-12.208-5.032m189.963-14.288L612.29 150.2l-36.36-.131c-32.538-.118-36.354.463-36.314 5.524.04 5.128 3.33 20.284 4.373 20.14.237-.033 15.701-5.791 34.366-12.797zm-443.494-2.28 3.468-10.287-30.466-1.024c-16.757-.564-30.464-.132-30.46.958.006 1.595 52.507 22.107 53.662 20.965.18-.178 1.889-4.954 3.796-10.612m208.91-31.887c7.166 1.146 15.25 4.08 17.962 6.519 4.213 3.788 6.045 3.53 12.562-1.77 4.196-3.413 9.65-6.205 12.12-6.205s4.49-.713 4.49-1.584c0-3.01-46.54-79.213-48.315-79.11-2.085.12-49.786 80.088-51.255 85.924-.616 2.45 1.318 3.354 5.074 2.372 3.338-.873 7.954.683 10.257 3.458 3.736 4.501 5.261 4.143 14.131-3.32 8.426-7.091 11.93-8.05 22.973-6.284" style="fill:#333;fill-opacity:1" transform="translate(-35.397 -30.558)" {
                }
                path d="M309.546 140.88c-.501-.234-1.118-.769-2.528-2.191-1.912-1.93-2.672-2.49-4.261-3.146-2.088-.862-4.355-1.095-6.482-.664-1.898.384-2.425.425-3.283.257-1.432-.279-1.941-1.149-1.536-2.622.506-1.837 4.337-8.943 12.01-22.274 15.583-27.08 36.536-61.221 38.85-63.307.256-.23.265-.23.522 0 1.378 1.236 9.477 13.726 20.54 31.679 14.968 24.285 27.412 45.643 27.412 47.047 0 .858-1.316 1.372-4.086 1.599-3.442.28-7.425 2.302-12.869 6.529-2.587 2.009-3.691 2.76-4.95 3.364-1.05.505-1.138.525-2.27.525-1.113 0-1.226-.025-2.095-.461-.513-.258-1.505-.95-2.242-1.564-2.178-1.816-4.8-3.136-9.072-4.571-5.43-1.824-11.244-2.919-16.195-3.05-3.91-.102-5.712.249-8.676 1.69-2.42 1.178-3.587 2.014-9.125 6.542-5.634 4.606-7.635 5.562-9.664 4.617M128.638 170.739c-10.16-2.96-45.503-16.92-50.451-19.925-.683-.415-.738-.478-.543-.62 1.131-.828 12.338-1.24 25.004-.919 5.051.128 35.501 1.133 35.55 1.174.1.081-6.521 19.289-7.03 20.394-.212.462-.65.444-2.53-.104M543.694 175.31c-1.386-2.712-3.888-14.97-3.96-19.408-.03-1.724.186-2.427.96-3.14 1.774-1.636 5.38-2.224 15.29-2.495 5.004-.137 28.102-.158 44.411-.04l11.429.082-27.518 10.314c-25.093 9.405-39.684 14.841-40.225 14.985-.135.036-.27-.068-.387-.297M178.088 315.514c0-.77 3.27-6.533 11.554-20.367 19.851-33.146 28.927-45.16 40.073-53.044 9.971-7.053 15.303-11.93 21.246-19.43l3.664-4.625 4.94 4.856c8.647 8.502 13.86 10.967 23.297 11.015 11.54.058 24.178-6.388 24.178-12.333 0-1.34.954-2.723 1.879-2.723.391 0 2.617.684 4.945 1.52 6.07 2.177 9.63 2.965 14.61 3.231 4.94.264 8.548-.17 13.358-1.608 4.725-1.413 7.447-2.86 15.598-8.29 4.108-2.735 7.6-4.974 7.76-4.974s3.125 1.719 6.589 3.82c3.463 2.1 7.625 4.381 9.248 5.067 11.07 4.68 23.025 4.374 33.972-.867 1.958-.937 6.568-3.73 10.244-6.207s6.736-4.446 6.8-4.376c.062.07 1.455 2.92 3.095 6.336 1.64 3.415 3.699 7.266 4.577 8.559 3.8 5.596 8.175 9.751 14.083 13.375 6.081 3.73 9.832 8.686 10.219 13.505.384 4.78-1.703 9.019-7.722 15.687-4.698 5.204-5.873 7.235-5.861 10.125.012 2.892 1.7 6.228 4.67 9.224 4.805 4.848 12.346 6.287 23.435 4.473 2.474-.405 5.595-.738 6.935-.74 4.285-.006 6.903 2.096 11.892 9.549 3.444 5.144 10.974 17.755 10.974 18.378 0 .324-.351.552-.85.552-1.052 0-5.624-1.243-8.933-2.43-4.348-1.558-57.272-22.005-74.748-28.878-46.663-18.351-62.028-24.212-69.536-26.524-8.115-2.5-13.64-3.086-18.127-1.923-5.58 1.445-81.72 30.868-126.132 48.741-21.932 8.826-24.678 9.876-28.782 11.002-3.263.895-3.144.883-3.144.324" style="fill:#6398aa;fill-opacity:1;stroke:none" transform="translate(-35.397 -30.558)" {
                }
            }
        }
    }

    fn run_instructions(&self, main_file: PathBuf, _other_files: Vec<PathBuf>) -> RunInstructions {
        RunInstructions {
            build_commands: vec![],
            run_command: format!("groovy {}", main_file.display()),
        }
    }
}
